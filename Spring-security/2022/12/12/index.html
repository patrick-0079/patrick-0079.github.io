<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="cthulhu">
    <meta name="description" content="Patrick&#39;s Blog">
    <meta name="author" content="Patrick">
    
    <title>
        
            Spring security |
        
        Patrick&#39;s blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.ico">
    
<link rel="stylesheet" href="/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/css/v5-font-face.min.css">

    
<link rel="stylesheet" href="/css/duotone.min.css">

    
<link rel="stylesheet" href="/css/brands.min.css">

    
<link rel="stylesheet" href="/css/solid.min.css">

    
<link rel="stylesheet" href="/css/css2.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script id="hexo-configurations">
    let REDEFINE = window.REDEFINE || {};
    REDEFINE.hexo_config = {"hostname":"patrick-0079.github.io","root":"/","language":"zh-CN","path":"search.xml"};
    REDEFINE.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#005080","avatar":"/images/avatar.jpg","favicon":"/images/logo.ico","article_img_align":"center","right_side_width":"210px","content_max_width":"1000px","nav_color":{"left":"#f78736","right":"#367df7","transparency":35},"hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"background_image":{"light":"/images/light.jpg","dark":"/images/dark.jpg"},"title_color":{"light":"#fff","dark":"#d1d1b6"},"description":"Ph'nglui mglw'nafh Cthulhu R'lyeh wgah'nagl fhtagn"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"0.3.5"};
    REDEFINE.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">
    
    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Patrick&#39;s blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               target="_blank" rel="noopener" href="https://xavier72bit.github.io/"
                            >
                                XAVIER&#39;S BLOG
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       target="_blank" rel="noopener" href="https://xavier72bit.github.io/">XAVIER&#39;S BLOG</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">
            <div class="article-title">
                <span class="title-hover-animation"><h1 style="font-size:2rem; font-weight: bold; margin: 10px 0;">Spring security</h1></span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/avatar.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Patrick</span>
                            
                        </div>
                        <div class="meta-info">
                            <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-duotone fa-pen-line"></i>&nbsp;
        <span class="pc">2022-12-12 11:39:18</span>
        <span class="mobile">2022-12-12 11:39</span>
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-duotone fa-tags"></i></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/spring-security/">spring security</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>5.4k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>26 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content markdown-body">
                <h1 id="关键过滤器"><a href="#关键过滤器" class="headerlink" title="关键过滤器"></a><strong>关键过滤器</strong></h1><h2 id="org-springframework-security-web-access-intercept-FilterSecurityInterceptor"><a href="#org-springframework-security-web-access-intercept-FilterSecurityInterceptor" class="headerlink" title="org.springframework.security.web.access.intercept.FilterSecurityInterceptor"></a>org.springframework.security.web.access.intercept.FilterSecurityInterceptor</h2><p>方法级权限过滤器，位于过滤链最底部</p>
<h2 id="org-springframework-security-web-access-ExceptionTranslationFilter"><a href="#org-springframework-security-web-access-ExceptionTranslationFilter" class="headerlink" title="org.springframework.security.web.access.ExceptionTranslationFilter"></a>org.springframework.security.web.access.ExceptionTranslationFilter</h2><p>异常过滤器，处理认证授权过程中抛出的异常</p>
<h2 id="org-springframework-security-web-authentication-UsernamePasswordAuthenticationFilter"><a href="#org-springframework-security-web-authentication-UsernamePasswordAuthenticationFilter" class="headerlink" title="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter"></a>org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter</h2><p>校验&#x2F;login（POST）请求提交的用户名和密码</p>
<hr>
<h1 id="过滤器加载流程"><a href="#过滤器加载流程" class="headerlink" title="过滤器加载流程"></a><strong>过滤器加载流程</strong></h1><p>使用Spring Security配置过滤器（懒加载）</p>
<h2 id="org-springframework-web-filter-DelegatingFilterProxy-doFilter"><a href="#org-springframework-web-filter-DelegatingFilterProxy-doFilter" class="headerlink" title="org.springframework.web.filter.DelegatingFilterProxy.doFilter()"></a>org.springframework.web.filter.DelegatingFilterProxy.doFilter()</h2><p>执行Filter initDelegate(WebApplicationContext wac)方法来获取org.springframework.security.web.FilterChainProxy这个Filter</p>
<h2 id="org-springframework-security-web-FilterChainProxy-doFilter"><a href="#org-springframework-security-web-FilterChainProxy-doFilter" class="headerlink" title="org.springframework.security.web.FilterChainProxy.doFilter()"></a>org.springframework.security.web.FilterChainProxy.doFilter()</h2><p>执行void doFilterInternal(ServletRequest request, ServletResponse response, FilterChain chain)方法来注册Spring Security的过滤器</p>
<hr>
<h1 id="涉及到的过滤器"><a href="#涉及到的过滤器" class="headerlink" title="涉及到的过滤器"></a><strong>涉及到的过滤器</strong></h1><h2 id="org-springframework-security-web-session-DisableEncodeUrlFilter"><a href="#org-springframework-security-web-session-DisableEncodeUrlFilter" class="headerlink" title="org.springframework.security.web.session.DisableEncodeUrlFilter"></a>org.springframework.security.web.session.DisableEncodeUrlFilter</h2><p>Disables encoding URLs using the HttpServletResponse to prevent including the session id in URLs which is not considered URL because the session id can be leaked in things like HTTP access logs.</p>
<p>禁用使用HttpServletResponse对URL进行编码，以防止在URL中包含会话id，因为会话id可能会在HTTP访问日志等内容中泄漏，因此不被视为URL。</p>
<h2 id="org-springframework-security-web-context-request-async-WebAsyncManagerIntegrationFilter"><a href="#org-springframework-security-web-context-request-async-WebAsyncManagerIntegrationFilter" class="headerlink" title="org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter"></a>org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter</h2><p>Provides integration between the SecurityContext and Spring Web’s WebAsyncManager by using the SecurityContextCallableProcessingInterceptor.beforeConcurrentHandling(org.springframework.web.context.request.NativeWebRequest, Callable) to populate the SecurityContext on the Callable.</p>
<p>通过使用SecurityContextCallableProcessingInterceptor.beforencurrentHandling（org.springframework.Web.context.request.NativeWebRequest，Callable）在可调用对象上填充SecurityContext，提供SecurityContext和Spring Web的WebAsyncManager之间的集成。</p>
<h2 id="org-springframework-security-web-context-SecurityContextPersistenceFilter"><a href="#org-springframework-security-web-context-SecurityContextPersistenceFilter" class="headerlink" title="org.springframework.security.web.context.SecurityContextPersistenceFilter"></a><del>org.springframework.security.web.context.SecurityContextPersistenceFilter</del></h2><p>Populates the SecurityContextHolder with information obtained from the configured SecurityContextRepository prior to the request and stores it back in the repository once the request has completed and clearing the context holder. By default it uses an HttpSessionSecurityContextRepository. See this class for information HttpSession related configuration options.<br>This filter will only execute once per request, to resolve servlet container (specifically Weblogic) incompatibilities.<br>This filter MUST be executed BEFORE any authentication processing mechanisms. Authentication processing mechanisms (e.g. BASIC, CAS processing filters etc) expect the SecurityContextHolder to contain a valid SecurityContext by the time they execute.<br>This is essentially a refactoring of the old HttpSessionContextIntegrationFilter to delegate the storage issues to a separate strategy, allowing for more customization in the way the security context is maintained between requests.<br>The forceEagerSessionCreation property can be used to ensure that a session is always available before the filter chain executes (the default is false, as this is resource intensive and not recommended).</p>
<p>使用请求之前从配置的SecurityContextRepository获得的信息填充SecurityContextHolder，并在请求完成并清除上下文持有者后将其存储回存储库中。默认情况下，它使用HttpSessionSecurityContextRepository。有关HttpSession相关配置选项的信息，请参阅此类。<br>每个请求只执行一次该过滤器，以解决servlet容器（特别是Weblogic）不兼容问题。<br>必须在任何身份验证处理机制之前执行此筛选器。身份验证处理机制（例如BASIC、CAS处理过滤器等）期望SecurityContextHolder在执行时包含有效的SecurityContext。<br>这本质上是对旧HttpSessionContextIntegrationFilter的重构，以将存储问题委托给一个单独的策略，从而允许在请求之间维护安全上下文的方式进行更多的定制。<br>forceEagleSessionCreation属性可用于确保在筛选器链执行之前会话始终可用（默认值为false，因为这是资源密集型的，不建议使用）。</p>
<p>已弃用,替代者: org.springframework.security.web.context.SecurityContextHolderFilter:</p>
<p>A javax.servlet.Filter that uses the SecurityContextRepository to obtain the SecurityContext and set it on the SecurityContextHolder. This is similar to SecurityContextPersistenceFilter except that the SecurityContextRepository.saveContext(SecurityContext, HttpServletRequest, HttpServletResponse) must be explicitly invoked to save the SecurityContext. This improves the efficiency and provides better flexibility by allowing different authentication mechanisms to choose individually if authentication should be persisted.</p>
<p>javax.servlet。使用SecurityContextRepository获取SecurityContext并在SecurityContextHolder上设置它的筛选器。除了SecurityContextRepository之外，这与SecurityContextPersistenceFilter类似。必须显式调用saveContext（SecurityContext、HttpServletRequest、HttpServletsResponse）来保存SecurityContext。这通过允许不同的身份验证机制单独选择是否应持久化身份验证，提高了效率并提供了更好的灵活性。</p>
<h2 id="org-springframework-security-web-header-HeaderWriterFilter"><a href="#org-springframework-security-web-header-HeaderWriterFilter" class="headerlink" title="org.springframework.security.web.header.HeaderWriterFilter"></a>org.springframework.security.web.header.HeaderWriterFilter</h2><p>Filter implementation to add headers to the current response. Can be useful to add certain headers which enable browser protection. Like X-Frame-Options, X-XSS-Protection and X-Content-Type-Options.<br>筛选器实现以向当前响应添加标头。添加启用浏览器保护的某些标头可能很有用。与X-Frame-Options、X-XSS-Protect和X-Content-Type-Options类似。</p>
<h1 id="org-springframework-security-web-csrf-CsrfFilter"><a href="#org-springframework-security-web-csrf-CsrfFilter" class="headerlink" title="org.springframework.security.web.csrf.CsrfFilter"></a>org.springframework.security.web.csrf.CsrfFilter</h1><p>Applies CSRF protection using a synchronizer token pattern. Developers are required to ensure that CsrfFilter is invoked for any request that allows state to change. Typically this just means that they should ensure their web application follows proper REST semantics (i.e. do not change state with the HTTP methods GET, HEAD, TRACE, OPTIONS).<br>Typically the CsrfTokenRepository implementation chooses to store the CsrfToken in HttpSession with HttpSessionCsrfTokenRepository wrapped by a LazyCsrfTokenRepository. This is preferred to storing the token in a cookie which can be modified by a client application.</p>
<p>使用同步器令牌模式应用CSRF保护。开发人员必须确保对任何允许状态更改的请求调用CsrfFilter。通常，这意味着他们应该确保他们的web应用程序遵循正确的REST语义（即，不要使用HTTP方法GET、HEAD、TRACE和OPTIONS更改状态）。<br>通常，CsrfTokenRepository实现选择将CsrfToken存储在HttpSession中，HttpSessionCsrfTokenRepository由LazySrfTokenStore封装。这比将令牌存储在可由客户端应用程序修改的cookie中更可取。</p>
<h1 id="org-springframework-security-web-authentication-logout-LogoutFilter"><a href="#org-springframework-security-web-authentication-logout-LogoutFilter" class="headerlink" title="org.springframework.security.web.authentication.logout.LogoutFilter"></a>org.springframework.security.web.authentication.logout.LogoutFilter</h1><p>Logs a principal out.<br>Polls a series of LogoutHandlers. The handlers should be specified in the order they are required. Generally you will want to call logout handlers TokenBasedRememberMeServices and SecurityContextLogoutHandler (in that order).<br>After logout, a redirect will be performed to the URL determined by either the configured LogoutSuccessHandler or the logoutSuccessUrl, depending on which constructor was used.</p>
<p>注销委托人。<br>轮询一系列LogoutHandler。应按照所需的顺序指定处理程序。通常，您需要调用注销处理程序TokenBasedRememberMeServices和SecurityContextLogoutHandler（按顺序）。<br>注销后，将根据使用的构造函数，重定向到由配置的LogoutSuccessHandler或LogoutSucceUrl确定的URL。</p>
<h2 id="org-springframework-security-web-authentication-UsernamePasswordAuthenticationFilter-1"><a href="#org-springframework-security-web-authentication-UsernamePasswordAuthenticationFilter-1" class="headerlink" title="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter"></a>org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter</h2><p>Processes an authentication form submission. Called AuthenticationProcessingFilter prior to Spring Security 3.0.<br>Login forms must present two parameters to this filter: a username and password. The default parameter names to use are contained in the static fields SPRING_SECURITY_FORM_USERNAME_KEY and SPRING_SECURITY_FORM_PASSWORD_KEY. The parameter names can also be changed by setting the usernameParameter and passwordParameter properties.<br>This filter by default responds to the URL &#x2F;login.</p>
<p>处理身份验证表单提交。在Spring Security 3.0之前调用AuthenticationProcessingFilter。<br>登录表单必须为此筛选器提供两个参数：用户名和密码。要使用的默认参数名包含在静态字段SPRING_SECURITY_FORM_USERNAME_KEY和SPRING_SETURITY_FFORM_PASSWORD_KEY中。还可以通过设置usernameParameter和passwordParameter属性来更改参数名称。<br>默认情况下，此筛选器响应URL&#x2F;登录。</p>
<h1 id="org-springframework-security-web-authentication-ui-DefaultLoginPageGeneratingFilter"><a href="#org-springframework-security-web-authentication-ui-DefaultLoginPageGeneratingFilter" class="headerlink" title="org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter"></a>org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter</h1><p>For internal use with namespace configuration in the case where a user doesn’t configure a login page. The configuration code will insert this filter in the chain instead. Will only work if a redirect is used to the login page.</p>
<p>在用户未配置登录页面的情况下，用于内部命名空间配置。配置代码将在链中插入此筛选器。仅当重定向到登录页面时才有效。</p>
<h1 id="org-springframework-security-web-authentication-ui-DefaultLogoutPageGeneratingFilter"><a href="#org-springframework-security-web-authentication-ui-DefaultLogoutPageGeneratingFilter" class="headerlink" title="org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter"></a>org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter</h1><p>Generates a default log out page.</p>
<p>生成默认注销页面。</p>
<h2 id="org-springframework-security-web-authentication-www-BasicAuthenticationFilter"><a href="#org-springframework-security-web-authentication-www-BasicAuthenticationFilter" class="headerlink" title="org.springframework.security.web.authentication.www.BasicAuthenticationFilter"></a>org.springframework.security.web.authentication.<a class="link"   target="_blank" rel="noopener" href="http://www.basicauthenticationfilter/" >www.BasicAuthenticationFilter<i class="fas fa-external-link-alt"></i></a></h2><p>Processes a HTTP request’s BASIC authorization headers, putting the result into the SecurityContextHolder.<br>For a detailed background on what this filter is designed to process, refer to RFC 1945, Section 11.1 . Any realm name presented in the HTTP request is ignored.<br>In summary, this filter is responsible for processing any request that has a HTTP request header of Authorization with an authentication scheme of Basic and a Base64-encoded username:password token. For example, to authenticate user “Aladdin” with password “open sesame” the following header would be presented:<br>    Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ&#x3D;&#x3D;<br>This filter can be used to provide BASIC authentication services to both remoting protocol clients (such as Hessian and SOAP) as well as standard user agents (such as Internet Explorer and Netscape).<br>If authentication is successful, the resulting Authentication object will be placed into the SecurityContextHolder.<br>If authentication fails and ignoreFailure is false (the default), an AuthenticationEntryPoint implementation is called (unless the ignoreFailure property is set to true). Usually this should be BasicAuthenticationEntryPoint, which will prompt the user to authenticate again via BASIC authentication.<br>Basic authentication is an attractive protocol because it is simple and widely deployed. However, it still transmits a password in clear text and as such is undesirable in many situations. Digest authentication is also provided by Spring Security and should be used instead of Basic authentication wherever possible. See DigestAuthenticationFilter.<br>Note that if a RememberMeServices is set, this filter will automatically send back remember-me details to the client. Therefore, subsequent requests will not need to present a BASIC authentication header as they will be authenticated using the remember-me mechanism.</p>
<p>处理HTTP请求的BASIC授权头，将结果放入SecurityContextHolder。<br>有关此筛选器设计处理的详细背景信息，请参阅RFC 1945第11.1节。HTTP请求中出现的任何领域名称都将被忽略。<br>总之，此筛选器负责处理具有HTTP请求头Authorization、身份验证方案为Basic和Base64编码的用户名：密码令牌的任何请求。例如，要使用密码“open芝麻”验证用户“Aladdin”，将显示以下标头：<br>授权：基本QWxhZGRpbjpvcGVuIHNlc2FtZQ&#x3D;&#x3D;<br>此筛选器可用于向远程协议客户端（如Hessian和SOAP）以及标准用户代理（如Internet Explorer和Netscape）提供BASIC身份验证服务。<br>如果身份验证成功，则生成的身份验证对象将被放置到SecurityContextHolder中。<br>如果身份验证失败且ignoreFailure为false（默认值），则调用AuthenticationEntryPoint实现（除非ignoreFailion属性设置为true）。通常这应该是BasicAuthenticationEntryPoint，它将提示用户通过BASIC身份验证再次进行身份验证。<br>基本身份验证是一个有吸引力的协议，因为它简单且部署广泛。然而，它仍然以明文形式传输密码，因此在许多情况下是不可取的。摘要式身份验证也由SpringSecurity提供，应尽可能使用它来代替基本身份验证。请参阅DigestAuthenticationFilter。<br>请注意，如果设置了RememberMeServices，则此过滤器将自动向客户端发回记住我的详细信息。因此，后续请求不需要呈现BASIC认证头，因为它们将使用记住我的机制进行认证。</p>
<h2 id="org-springframework-security-web-savedrequest-RequestCacheAwareFilter"><a href="#org-springframework-security-web-savedrequest-RequestCacheAwareFilter" class="headerlink" title="org.springframework.security.web.savedrequest.RequestCacheAwareFilter"></a>org.springframework.security.web.savedrequest.RequestCacheAwareFilter</h2><p>Responsible for reconstituting the saved request if one is cached and it matches the current request.<br>It will call getMatchingRequest on the configured RequestCache. If the method returns a value (a wrapper of the saved request), it will pass this to the filter chain’s doFilter method. If null is returned by the cache, the original request is used and the filter has no effect.</p>
<p>负责重新构建保存的请求，如果其中一个请求被缓存并且与当前请求匹配。<br>它将在配置的RequestCache上调用getMatchingRequest。如果该方法返回一个值（保存的请求的包装器），它会将其传递给过滤器链的doFilter方法。如果缓存返回null，则使用原始请求，过滤器无效。</p>
<h2 id="org-springframework-security-web-servletapi-SecurityContextHolderAwareRequestFilter"><a href="#org-springframework-security-web-servletapi-SecurityContextHolderAwareRequestFilter" class="headerlink" title="org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter"></a>org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter</h2><p>A Filter which populates the ServletRequest with a request wrapper which implements the servlet API security methods.<br>SecurityContextHolderAwareRequestWrapper is extended to provide the following additional methods:<br>HttpServletRequest.authenticate(HttpServletResponse) - Allows the user to determine if they are authenticated and if not send the user to the login page. See setAuthenticationEntryPoint(AuthenticationEntryPoint).<br>HttpServletRequest.login(String, String) - Allows the user to authenticate using the AuthenticationManager. See setAuthenticationManager(AuthenticationManager).<br>HttpServletRequest.logout() - Allows the user to logout using the LogoutHandlers configured in Spring Security. See setLogoutHandlers(List).<br>AsyncContext.start(Runnable) - Automatically copy the SecurityContext from the SecurityContextHolder found on the Thread that invoked AsyncContext.start(Runnable) to the Thread that processes the Runnable.</p>
<p>一个过滤器，用实现servlet API安全方法的请求包装器填充ServletRequest。<br>SecurityContextHolderAwareRequestWrapper被扩展以提供以下附加方法：</p>
<ul>
<li>HttpServletRequest.authenticate（HttpServletResponse）-允许用户确定他们是否经过身份验证，如果没有，则将用户发送到登录页面。请参见setAuthenticationEntryPoint（AuthenticationEntrePoint）。  </li>
<li>HttpServletRequest.login（String，String）-允许用户使用AuthenticationManager进行身份验证。请参阅setAuthenticationManager（AuthenticationManager）。  </li>
<li>HttpServletRequest.logout（）-允许用户使用Spring Security中配置的LogoutHandlers注销。请参见setLogoutHandlers（列表）。  </li>
<li>AsyncContext.start（Runnable）-自动从调用AsyncContext的线程上找到的SecurityContextHolder复制SecurityContext。启动（Runnable）到处理Runnable的线程。</li>
</ul>
<h2 id="org-springframework-security-web-authentication-AnonymousAuthenticationFilter"><a href="#org-springframework-security-web-authentication-AnonymousAuthenticationFilter" class="headerlink" title="org.springframework.security.web.authentication.AnonymousAuthenticationFilter"></a>org.springframework.security.web.authentication.AnonymousAuthenticationFilter</h2><p>Detects if there is no Authentication object in the SecurityContextHolder, and populates it with one if needed.</p>
<p>检测SecurityContextHolder中是否没有身份验证对象，并在需要时用一个身份验证对象填充。</p>
<h2 id="org-springframework-security-web-session-SessionManagementFilter"><a href="#org-springframework-security-web-session-SessionManagementFilter" class="headerlink" title="org.springframework.security.web.session.SessionManagementFilter:"></a>org.springframework.security.web.session.SessionManagementFilter:</h2><p>Detects that a user has been authenticated since the start of the request and, if they have, calls the configured SessionAuthenticationStrategy to perform any session-related activity such as activating session-fixation protection mechanisms or checking for multiple concurrent logins.</p>
<p>检测用户自请求开始以来是否已通过身份验证，如果已通过，则调用配置的SessionAuthenticationStrategy以执行任何与会话相关的活动，例如激活会话固定保护机制或检查多个并发登录。</p>
<h2 id="org-springframework-security-web-access-ExceptionTranslationFilter-1"><a href="#org-springframework-security-web-access-ExceptionTranslationFilter-1" class="headerlink" title="org.springframework.security.web.access.ExceptionTranslationFilter:"></a>org.springframework.security.web.access.ExceptionTranslationFilter:</h2><p>Handles any AccessDeniedException and AuthenticationException thrown within the filter chain.<br>This filter is necessary because it provides the bridge between Java exceptions and HTTP responses. It is solely concerned with maintaining the user interface. This filter does not do any actual security enforcement.<br>If an AuthenticationException is detected, the filter will launch the authenticationEntryPoint. This allows common handling of authentication failures originating from any subclass of org.springframework.security.access.intercept.AbstractSecurityInterceptor.<br>If an AccessDeniedException is detected, the filter will determine whether or not the user is an anonymous user. If they are an anonymous user, the authenticationEntryPoint will be launched. If they are not an anonymous user, the filter will delegate to the AccessDeniedHandler. By default the filter will use AccessDeniedHandlerImpl.<br>To use this filter, it is necessary to specify the following properties:<br>authenticationEntryPoint indicates the handler that should commence the authentication process if an AuthenticationException is detected. Note that this may also switch the current protocol from http to https for an SSL login.<br>requestCache determines the strategy used to save a request during the authentication process in order that it may be retrieved and reused once the user has authenticated. The default implementation is HttpSessionRequestCache.</p>
<p>处理筛选器链中引发的任何AccessDeniedException和AuthenticationException。<br>这个过滤器是必要的，因为它提供了Java异常和HTTP响应之间的桥梁。它只关心维护用户界面。此筛选器不执行任何实际的安全强制。<br>如果检测到AuthenticationException，则过滤器将启动authenticationEntryPoint。这允许对源自org.springframework.security.access.intercept.AbstractSecurityInterceptor的任何子类的身份验证失败进行常见处理。<br>如果检测到AccessDeniedException，则筛选器将确定用户是否为匿名用户。如果他们是匿名用户，将启动authenticationEntryPoint。如果他们不是匿名用户，则筛选器将委托给AccessDeniedHandler。默认情况下，过滤器将使用AccessDeniedHandlerImpl。<br>要使用此筛选器，必须指定以下属性：</p>
<ul>
<li>authenticationEntryPoint指示在检测到AuthenticationException时应开始身份验证过程的处理程序。注意，对于SSL登录，这也可能会将当前协议从http切换为https。</li>
<li>requestCache确定用于在身份验证过程中保存请求的策略，以便在用户进行身份验证后可以检索和重用该请求。默认实现是HttpSessionRequestCache。</li>
</ul>
<h2 id="org-springframework-security-web-access-intercept-FilterSecurityInterceptor-1"><a href="#org-springframework-security-web-access-intercept-FilterSecurityInterceptor-1" class="headerlink" title="org.springframework.security.web.access.intercept.FilterSecurityInterceptor:"></a>org.springframework.security.web.access.intercept.FilterSecurityInterceptor:</h2><p>Performs security handling of HTTP resources via a filter implementation.<br>The SecurityMetadataSource required by this security interceptor is of type FilterInvocationSecurityMetadataSource.<br>Refer to AbstractSecurityInterceptor for details on the workflow.</p>
<p>通过过滤器实现执行HTTP资源的安全处理。<br>此安全拦截器所需的SecurityMetadataSource的类型为FilterInvocationSecurityMetadataSource。<br>有关工作流的详细信息，请参阅AbstractSecurityInterceptor。</p>
<hr>
<h1 id="实现自定义的账号密码验证逻辑"><a href="#实现自定义的账号密码验证逻辑" class="headerlink" title="实现自定义的账号密码验证逻辑"></a><strong>实现自定义的账号密码验证逻辑</strong></h1><h2 id="创建org-springframework-security-web-authentication-UsernamePasswordAuthenticationFilter子类，重写下列方法"><a href="#创建org-springframework-security-web-authentication-UsernamePasswordAuthenticationFilter子类，重写下列方法" class="headerlink" title="创建org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter子类，重写下列方法:"></a>创建org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter子类，重写下列方法:</h2><ul>
<li>Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response)</li>
<li>void successfulAuthentication(HttpServletRequest request, HttpServletResponse response, FilterChain chain, Authentication authResult)</li>
<li>void unsuccessfulAuthentication(HttpServletRequest request, HttpServletResponse response, AuthenticationException failed)</li>
</ul>
<h3 id="Authentication-attemptAuthentication-HttpServletRequest-request-HttpServletResponse-response"><a href="#Authentication-attemptAuthentication-HttpServletRequest-request-HttpServletResponse-response" class="headerlink" title="Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response)"></a>Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response)</h3><p>Performs actual authentication.<br>The implementation should do one of the following:<br>    Return a populated authentication token for the authenticated user, indicating successful authentication<br>    Return null, indicating that the authentication process is still in progress. Before returning, the implementation should perform any additional work required to complete the process.<br>    Throw an AuthenticationException if the authentication process fails</p>
<p>执行实际身份验证。<br>实施应执行以下操作之一：</p>
<ul>
<li>为经过身份验证的用户返回填充的身份验证令牌，表示身份验证成功</li>
<li>返回null，表示身份验证过程仍在进行中。在返回之前，实施应执行完成流程所需的任何额外工作。</li>
<li>如果身份验证过程失败，则引发AuthenticationException</li>
</ul>
<h3 id="void-successfulAuthentication-HttpServletRequest-request-HttpServletResponse-response-FilterChain-chain-Authentication-authResult"><a href="#void-successfulAuthentication-HttpServletRequest-request-HttpServletResponse-response-FilterChain-chain-Authentication-authResult" class="headerlink" title="void successfulAuthentication(HttpServletRequest request, HttpServletResponse response, FilterChain chain, Authentication authResult):"></a>void successfulAuthentication(HttpServletRequest request, HttpServletResponse response, FilterChain chain, Authentication authResult):</h3><p>Default behaviour for successful authentication:<br>    Sets the successful Authentication object on the SecurityContextHolder<br>    Informs the configured RememberMeServices of the successful login<br>    Fires an InteractiveAuthenticationSuccessEvent via the configured ApplicationEventPublisher<br>    Delegates additional behaviour to the AuthenticationSuccessHandler.<br>Subclasses can override this method to continue the FilterChain after successful authentication.</p>
<p>成功身份验证的默认行为:</p>
<ul>
<li>在SecurityContextHolder上设置成功的身份验证对象</li>
<li>通知已配置的RememberMeServices成功登录</li>
<li>通过配置的ApplicationEventPublisher激发InteractiveAuthenticationSuccessEvent</li>
<li>将其他行为委托给AuthenticationSuccessHandler。<br>子类可以重写此方法以在成功身份验证后继续FilterChain。</li>
</ul>
<h3 id="void-unsuccessfulAuthentication-HttpServletRequest-request-HttpServletResponse-response-AuthenticationException-failed"><a href="#void-unsuccessfulAuthentication-HttpServletRequest-request-HttpServletResponse-response-AuthenticationException-failed" class="headerlink" title="void unsuccessfulAuthentication(HttpServletRequest request, HttpServletResponse response, AuthenticationException failed):"></a>void unsuccessfulAuthentication(HttpServletRequest request, HttpServletResponse response, AuthenticationException failed):</h3><p>Default behaviour for unsuccessful authentication:<br>    Clears the SecurityContextHolder<br>    Stores the exception in the session (if it exists or allowSesssionCreation is set to true)<br>    Informs the configured RememberMeServices of the failed login<br>    Delegates additional behaviour to the AuthenticationFailureHandler.</p>
<p>身份验证失败的默认行为:</p>
<ul>
<li>清除SecurityContextHolder</li>
<li>将异常存储在会话中（如果它存在或allowSesssionCreation设置为true）</li>
<li>通知配置的RememberMeServices登录失败</li>
<li>将其他行为委托给AuthenticationFailureHandler。</li>
</ul>
<h2 id="实现org-springframework-security-core-userdetails-UserDetailsService接口"><a href="#实现org-springframework-security-core-userdetails-UserDetailsService接口" class="headerlink" title="实现org.springframework.security.core.userdetails.UserDetailsService接口:"></a>实现org.springframework.security.core.userdetails.UserDetailsService接口:</h2><h3 id="UserDetails-loadUserByUsername-String-username"><a href="#UserDetails-loadUserByUsername-String-username" class="headerlink" title="UserDetails loadUserByUsername(String username)"></a>UserDetails loadUserByUsername(String username)</h3><p>Locates the user based on the username. In the actual implementation, the search may possibly be case sensitive, or case insensitive depending on how the implementation instance is configured. In this case, the UserDetails object that comes back may have a username that is of a different case than what was actually requested..</p>
<p>根据用户名查找用户。在实际实现中，搜索可能区分大小写，或者不区分大小写（取决于实现实例的配置方式）。在这种情况下，返回的UserDetails对象的用户名可能与实际请求的用户名不同。</p>
<h2 id="实现org-springframework-security-crypto-password-PasswordEncoder接口"><a href="#实现org-springframework-security-crypto-password-PasswordEncoder接口" class="headerlink" title="实现org.springframework.security.crypto.password.PasswordEncoder接口:"></a>实现org.springframework.security.crypto.password.PasswordEncoder接口:</h2><h3 id="String-encode-CharSequence-rawPassword"><a href="#String-encode-CharSequence-rawPassword" class="headerlink" title="String encode(CharSequence rawPassword)"></a>String encode(CharSequence rawPassword)</h3><p>Encode the raw password. Generally, a good encoding algorithm applies a SHA-1 or greater hash combined with an 8-byte or greater randomly generated salt.</p>
<p>对原始密码进行编码。通常，一个好的编码算法应用SHA-1或更大的散列，并结合8字节或更大随机生成的盐。</p>
<h3 id="boolean-matches-CharSequence-rawPassword-String-encodedPassword"><a href="#boolean-matches-CharSequence-rawPassword-String-encodedPassword" class="headerlink" title="boolean matches(CharSequence rawPassword, String encodedPassword)"></a>boolean matches(CharSequence rawPassword, String encodedPassword)</h3><p>Verify the encoded password obtained from storage matches the submitted raw password after it too is encoded. Returns true if the passwords match, false if they do not. The stored password itself is never decoded.</p>
<p>验证从存储中获得的编码密码与提交的原始密码是否匹配。如果密码匹配，则返回true，否则返回false。存储的密码本身永远不会被解码。</p>
<h3 id="boolean-upgradeEncoding-String-encodedPassword"><a href="#boolean-upgradeEncoding-String-encodedPassword" class="headerlink" title="boolean upgradeEncoding(String encodedPassword):"></a>boolean upgradeEncoding(String encodedPassword):</h3><p>Returns true if the encoded password should be encoded again for better security, else false. The default implementation always returns false.</p>
<p>如果为了更好的安全性，应再次对编码的密码进行编码，则返回true，否则返回false。默认实现始终返回false。</p>
<hr>
<h1 id="设置登录的用户名和密码"><a href="#设置登录的用户名和密码" class="headerlink" title="设置登录的用户名和密码"></a><strong>设置登录的用户名和密码</strong></h1><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><div class="highlight-container" data-rel="Properties"><figure class="iseeu highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.security.user.name</span>=<span class="string">username</span></span><br><span class="line"><span class="attr">spring.security.user.password</span>=<span class="string">password</span></span><br></pre></td></tr></table></figure></div>
<h2 id="配置类"><a href="#配置类" class="headerlink" title="配置类"></a>配置类</h2><ul>
<li>继承自<del>org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter</del>类的配置类，现在已弃用。现在推荐配置UserDetailsService的Bean:</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Config</span>() &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    UserDetailsService <span class="title function_">userDetailsService</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 配置用户名和密码</span></span><br><span class="line">        <span class="type">InMemoryUserDetailsManager</span> <span class="variable">users</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryUserDetailsManager</span>();</span><br><span class="line">        users.createUser(User.withUsername(<span class="string">&quot;user&quot;</span>).password(<span class="string">&quot;password&quot;</span>).roles(<span class="string">&quot;admin&quot;</span>).build());</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置加密器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> PasswordEncoder <span class="title function_">passwordEncoder</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> NoOpPasswordEncoder.getInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<ul>
<li>实现org.springframework.security.core.userdetails.UserDetailsService接口</li>
</ul>
<hr>
<h1 id="访问权限配置"><a href="#访问权限配置" class="headerlink" title="访问权限配置"></a><strong>访问权限配置</strong></h1><p>配置SecurityFilterChain的Bean, 若配置发生冲突, 则以先匹配到的规则为准:</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityCustomizer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.UserDetailsService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.crypto.password.NoOpPasswordEncoder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.crypto.password.PasswordEncoder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.SecurityFilterChain;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.authentication.rememberme.PersistentTokenRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Config</span>() &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    SecurityFilterChain <span class="title function_">filterChain</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> http</span><br><span class="line">                .formLogin() <span class="comment">// 登录设置</span></span><br><span class="line">                .loginPage(<span class="string">&quot;/common/login&quot;</span>) <span class="comment">// 配置登录页面路径</span></span><br><span class="line">                .loginProcessingUrl(<span class="string">&quot;/login&quot;</span>) <span class="comment">// 登录数据处理路径</span></span><br><span class="line">                .defaultSuccessUrl(<span class="string">&quot;/common/index&quot;</span>) <span class="comment">// 登录成功后跳转路径</span></span><br><span class="line"></span><br><span class="line">                .and().logout().logoutUrl(<span class="string">&quot;/destroy&quot;</span>) <span class="comment">// 设置注销接口路径</span></span><br><span class="line">                .logoutSuccessUrl(<span class="string">&quot;/common/index&quot;</span>)<span class="comment">// 设置注销成功后跳转页面</span></span><br><span class="line">                .permitAll()</span><br><span class="line"></span><br><span class="line">                .and().authorizeRequests() <span class="comment">//配置页面访问权限</span></span><br><span class="line">                .antMatchers(<span class="string">&quot;/common/index&quot;</span>, <span class="string">&quot;/common/login&quot;</span>).permitAll() <span class="comment">// 设置可直接访问的路径</span></span><br><span class="line"></span><br><span class="line">                .antMatchers(<span class="string">&quot;/authority/boom&quot;</span>).hasAuthority(<span class="string">&quot;boom&quot;</span>) <span class="comment">//根据权限配置可访问路径</span></span><br><span class="line">                .antMatchers(<span class="string">&quot;/authority/read&quot;</span>).hasAuthority(<span class="string">&quot;read&quot;</span>)</span><br><span class="line">                .antMatchers(<span class="string">&quot;/authority/write&quot;</span>).hasAuthority(<span class="string">&quot;write&quot;</span>)</span><br><span class="line">                .antMatchers(<span class="string">&quot;/authority/read/write&quot;</span>).hasAnyAuthority(<span class="string">&quot;read&quot;</span>, <span class="string">&quot;write&quot;</span>)</span><br><span class="line"></span><br><span class="line">                .antMatchers(<span class="string">&quot;/role/boss&quot;</span>).hasRole(<span class="string">&quot;boss&quot;</span>) <span class="comment">//根据角色配置可访问路径</span></span><br><span class="line">                .antMatchers(<span class="string">&quot;/role/worker&quot;</span>).hasAuthority(<span class="string">&quot;ROLE_worker&quot;</span>)</span><br><span class="line">                .antMatchers(<span class="string">&quot;/role/root&quot;</span>).hasRole(<span class="string">&quot;root&quot;</span>)</span><br><span class="line">                .antMatchers(<span class="string">&quot;/role/boss/worker&quot;</span>).hasAnyRole(<span class="string">&quot;boss&quot;</span>, <span class="string">&quot;worker&quot;</span>)</span><br><span class="line"></span><br><span class="line">                .antMatchers(<span class="string">&quot;/ip/localhost&quot;</span>).hasIpAddress(<span class="string">&quot;192.168.0.0/16&quot;</span>) <span class="comment">//根据IP配置可访问路径</span></span><br><span class="line">                .antMatchers(<span class="string">&quot;/ip/localhost&quot;</span>).hasIpAddress(<span class="string">&quot;127.0.0.0/8&quot;</span>)</span><br><span class="line"></span><br><span class="line">                .anyRequest().authenticated() <span class="comment">// 其他所有页面皆为认证用户访问</span></span><br><span class="line"></span><br><span class="line">                .and().exceptionHandling().accessDeniedPage(<span class="string">&quot;/error/403.html&quot;</span>)<span class="comment">// 配置 403 路径</span></span><br><span class="line"></span><br><span class="line">                .and().csrf().disable() <span class="comment">// 关闭CSRF防护</span></span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<hr>
<h1 id="登录页面"><a href="#登录页面" class="headerlink" title="登录页面"></a><strong>登录页面</strong></h1><p>必须提交POST表单, 默认情况下, 用户名的name为username, 密码的name为password</p>
<hr>
<h1 id="注解"><a href="#注解" class="headerlink" title="注解"></a><strong>注解</strong></h1><p>先开在启动类开启 @EnableGlobalMethodSecurity</p>
<ul>
<li><p>@Secured<br>  先开在启动类开启 @EnableGlobalMethodSecurity(securedEnabled &#x3D; true),对角色进行访问控制, 使用时对角色前加ROLE_前缀, 不支持对资源进行访问控制<br>  例如</p>
<pre><code>  @Secured(&#123;&quot;ROLE_worker&quot;, &quot;ROLE_boss&quot;&#125;)
</code></pre>
</li>
<li><p>@PreAuthorize<br>  先开在启动类开启 @EnableGlobalMethodSecurity(prePostEnabled&#x3D;true),提供了基于表达式的访问控制<br>  例如:</p>
<pre><code>  @PreAuthorize(&quot;hasAnyRole(&#39;worker&#39;,&#39;boss&#39;)&quot;)
  @PreAuthorize(&quot;hasRole(&#39;worker&#39;) AND hasRole(&#39;boss&#39;)&quot;)
</code></pre>
</li>
<li><p>@PostAuthorize:<br>  先开在启动类开启 @EnableGlobalMethodSecurity(prePostEnabled&#x3D;true),在方法执行后再进行权限验证, 适合验证带有返回值的权限, Spring EL 提供 返回对象能够在表达式语言中获取返回的对象returnObject, 提供了基于表达式的访问控制<br>  例如</p>
<pre><code>  @PostAuthorize(&quot; returnObject != null &amp;&amp;  returnObject.username == authentication.name&quot;)
</code></pre>
</li>
<li><p>@PostFilter<br>  对返回数据过滤<br>  例如</p>
</li>
</ul>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.security.access.prepost.PostFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">controllerTest</span>() &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/post/filter&quot;)</span></span><br><span class="line">    <span class="meta">@PostFilter(&quot;filterObject.username == &#x27;1&#x27;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">PostFilter</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;User&gt; userList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        userList.add(<span class="keyword">new</span> <span class="title class_">User</span>().setUsername(<span class="string">&quot;1&quot;</span>));</span><br><span class="line">        userList.add(<span class="keyword">new</span> <span class="title class_">User</span>().setUsername(<span class="string">&quot;2&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> userList;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 返回数据</span></span><br><span class="line">        <span class="comment">// [&#123;</span></span><br><span class="line">        <span class="comment">// &quot;deleteFlag&quot;:null,</span></span><br><span class="line">        <span class="comment">// &quot;lockFlag&quot;:null,</span></span><br><span class="line">        <span class="comment">// &quot;userId&quot;:null,</span></span><br><span class="line">        <span class="comment">// &quot;username&quot;:&quot;1&quot;,</span></span><br><span class="line">        <span class="comment">// &quot;password&quot;:null,</span></span><br><span class="line">        <span class="comment">// &quot;authorities&quot;:null,</span></span><br><span class="line">        <span class="comment">// &quot;enabled&quot;:false,</span></span><br><span class="line">        <span class="comment">// &quot;credentialsNonExpired&quot;:false,</span></span><br><span class="line">        <span class="comment">// &quot;accountNonExpired&quot;:false,</span></span><br><span class="line">        <span class="comment">// &quot;accountNonLocked&quot;:false</span></span><br><span class="line">        <span class="comment">// &#125;]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<ul>
<li>@PreFilter<br>  对传入参数过滤<br>  例如  <div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">import</span> org.springframework.security.access.prepost.PostFilter;</span><br><span class="line">  <span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line">  <span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Controller</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">controllerTest</span>() &#123;</span><br><span class="line">      <span class="meta">@PostMapping(&quot;/pre/filter&quot;)</span></span><br><span class="line">      <span class="meta">@PostFilter(&quot;filterObject.username == &#x27;1&#x27;&quot;)</span></span><br><span class="line">      <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">PreFilter</span><span class="params">(<span class="meta">@RequestBody</span> List&lt;User&gt; userList)</span>&#123;</span><br><span class="line">          <span class="comment">// 传入数据</span></span><br><span class="line">          <span class="comment">//[&#123;</span></span><br><span class="line">          <span class="comment">//    &quot;username&quot;: &quot;1&quot;</span></span><br><span class="line">          <span class="comment">//&#125;,&#123;</span></span><br><span class="line">          <span class="comment">//    &quot;username&quot;: &quot;2&quot;</span></span><br><span class="line">          <span class="comment">//&#125;,&#123;</span></span><br><span class="line">          <span class="comment">//    &quot;username&quot;: &quot;3&quot;</span></span><br><span class="line">          <span class="comment">//&#125;]</span></span><br><span class="line">          <span class="keyword">return</span> userList;</span><br><span class="line">  </span><br><span class="line">          <span class="comment">// 返回数据</span></span><br><span class="line">          <span class="comment">//[</span></span><br><span class="line">          <span class="comment">//    &#123;</span></span><br><span class="line">          <span class="comment">//        &quot;deleteFlag&quot;: null,</span></span><br><span class="line">          <span class="comment">//        &quot;lockFlag&quot;: null,</span></span><br><span class="line">          <span class="comment">//        &quot;userId&quot;: null,</span></span><br><span class="line">          <span class="comment">//        &quot;username&quot;: &quot;1&quot;,</span></span><br><span class="line">          <span class="comment">//        &quot;password&quot;: null,</span></span><br><span class="line">          <span class="comment">//        &quot;authorities&quot;: null,</span></span><br><span class="line">          <span class="comment">//        &quot;enabled&quot;: false,</span></span><br><span class="line">          <span class="comment">//        &quot;credentialsNonExpired&quot;: false,</span></span><br><span class="line">          <span class="comment">//        &quot;accountNonExpired&quot;: false,</span></span><br><span class="line">          <span class="comment">//        &quot;accountNonLocked&quot;: false</span></span><br><span class="line">          <span class="comment">//    &#125;</span></span><br><span class="line">          <span class="comment">//]</span></span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li>
</ul>
<hr>
<h1 id="自动登录"><a href="#自动登录" class="headerlink" title="自动登录"></a><strong>自动登录</strong></h1><p>配置自动登录Service</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityCustomizer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.UserDetailsService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.crypto.password.NoOpPasswordEncoder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.crypto.password.PasswordEncoder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.SecurityFilterChain;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.authentication.rememberme.JdbcTokenRepositoryImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.authentication.rememberme.PersistentTokenRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Config</span>() &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    PersistentTokenRepository <span class="title function_">persistentTokenRepository</span><span class="params">(DataSource dataSource)</span> &#123;</span><br><span class="line">        <span class="type">JdbcTokenRepositoryImpl</span> <span class="variable">jdbcTokenRepository</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JdbcTokenRepositoryImpl</span>();</span><br><span class="line">        jdbcTokenRepository.setDataSource(dataSource);</span><br><span class="line">        <span class="comment">// jdbcTokenRepository.setCreateTableOnStartup(true); // 自动创建所需要的表</span></span><br><span class="line">        <span class="keyword">return</span> jdbcTokenRepository;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    SecurityFilterChain <span class="title function_">filterChain</span><span class="params">(HttpSecurity http,</span></span><br><span class="line"><span class="params">                                    PersistentTokenRepository persistentTokenRepository,</span></span><br><span class="line"><span class="params">                                    UserDetailsService userDetailsService)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> http.rememberMe().tokenRepository(persistentTokenRepository) <span class="comment">// 配置自动登录</span></span><br><span class="line">                .tokenValiditySeconds(<span class="number">60</span>)<span class="comment">// 自动登录有效时常</span></span><br><span class="line">                .userDetailsService(userDetailsService);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<span id="more"></span>
            </div>

            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/spring-security/">#spring security</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                            rel="prev"
                            href="/home/2022/12/13/"
                            >
                                <span class="left arrow-icon flex-center">
                                <i class="fas fa-chevron-left"></i>
                                </span>
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">home</span>
                                    <span class="post-nav-item">上一篇</span>
                                </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                            rel="next"
                            href="/index/2022/12/12/"
                            >
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">Archives</span>
                                    <span class="post-nav-item">下一篇</span>
                                </span>
                                <span class="right arrow-icon flex-center">
                                <i class="fas fa-chevron-right"></i>
                                </span>
                            </a>
                        </div>
                    
                </div>
            

            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <div style="font-size: 1.3rem;margin-top: 0; margin-bottom: 0.8rem; transition-duration: 0.1s;"><i class="fa-solid fa-list"></i> <strong>目录</strong></div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">1.</span> <span class="nav-text">关键过滤器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-access-intercept-FilterSecurityInterceptor"><span class="nav-number">1.1.</span> <span class="nav-text">org.springframework.security.web.access.intercept.FilterSecurityInterceptor</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-access-ExceptionTranslationFilter"><span class="nav-number">1.2.</span> <span class="nav-text">org.springframework.security.web.access.ExceptionTranslationFilter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-authentication-UsernamePasswordAuthenticationFilter"><span class="nav-number">1.3.</span> <span class="nav-text">org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E5%8A%A0%E8%BD%BD%E6%B5%81%E7%A8%8B"><span class="nav-number">2.</span> <span class="nav-text">过滤器加载流程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-web-filter-DelegatingFilterProxy-doFilter"><span class="nav-number">2.1.</span> <span class="nav-text">org.springframework.web.filter.DelegatingFilterProxy.doFilter()</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-FilterChainProxy-doFilter"><span class="nav-number">2.2.</span> <span class="nav-text">org.springframework.security.web.FilterChainProxy.doFilter()</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B6%89%E5%8F%8A%E5%88%B0%E7%9A%84%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">3.</span> <span class="nav-text">涉及到的过滤器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-session-DisableEncodeUrlFilter"><span class="nav-number">3.1.</span> <span class="nav-text">org.springframework.security.web.session.DisableEncodeUrlFilter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-context-request-async-WebAsyncManagerIntegrationFilter"><span class="nav-number">3.2.</span> <span class="nav-text">org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-context-SecurityContextPersistenceFilter"><span class="nav-number">3.3.</span> <span class="nav-text">org.springframework.security.web.context.SecurityContextPersistenceFilter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-header-HeaderWriterFilter"><span class="nav-number">3.4.</span> <span class="nav-text">org.springframework.security.web.header.HeaderWriterFilter</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#org-springframework-security-web-csrf-CsrfFilter"><span class="nav-number">4.</span> <span class="nav-text">org.springframework.security.web.csrf.CsrfFilter</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#org-springframework-security-web-authentication-logout-LogoutFilter"><span class="nav-number">5.</span> <span class="nav-text">org.springframework.security.web.authentication.logout.LogoutFilter</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-authentication-UsernamePasswordAuthenticationFilter-1"><span class="nav-number">5.1.</span> <span class="nav-text">org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#org-springframework-security-web-authentication-ui-DefaultLoginPageGeneratingFilter"><span class="nav-number">6.</span> <span class="nav-text">org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#org-springframework-security-web-authentication-ui-DefaultLogoutPageGeneratingFilter"><span class="nav-number">7.</span> <span class="nav-text">org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-authentication-www-BasicAuthenticationFilter"><span class="nav-number">7.1.</span> <span class="nav-text">org.springframework.security.web.authentication.www.BasicAuthenticationFilter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-savedrequest-RequestCacheAwareFilter"><span class="nav-number">7.2.</span> <span class="nav-text">org.springframework.security.web.savedrequest.RequestCacheAwareFilter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-servletapi-SecurityContextHolderAwareRequestFilter"><span class="nav-number">7.3.</span> <span class="nav-text">org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-authentication-AnonymousAuthenticationFilter"><span class="nav-number">7.4.</span> <span class="nav-text">org.springframework.security.web.authentication.AnonymousAuthenticationFilter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-session-SessionManagementFilter"><span class="nav-number">7.5.</span> <span class="nav-text">org.springframework.security.web.session.SessionManagementFilter:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-access-ExceptionTranslationFilter-1"><span class="nav-number">7.6.</span> <span class="nav-text">org.springframework.security.web.access.ExceptionTranslationFilter:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org-springframework-security-web-access-intercept-FilterSecurityInterceptor-1"><span class="nav-number">7.7.</span> <span class="nav-text">org.springframework.security.web.access.intercept.FilterSecurityInterceptor:</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81%E9%80%BB%E8%BE%91"><span class="nav-number">8.</span> <span class="nav-text">实现自定义的账号密码验证逻辑</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAorg-springframework-security-web-authentication-UsernamePasswordAuthenticationFilter%E5%AD%90%E7%B1%BB%EF%BC%8C%E9%87%8D%E5%86%99%E4%B8%8B%E5%88%97%E6%96%B9%E6%B3%95"><span class="nav-number">8.1.</span> <span class="nav-text">创建org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter子类，重写下列方法:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Authentication-attemptAuthentication-HttpServletRequest-request-HttpServletResponse-response"><span class="nav-number">8.1.1.</span> <span class="nav-text">Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#void-successfulAuthentication-HttpServletRequest-request-HttpServletResponse-response-FilterChain-chain-Authentication-authResult"><span class="nav-number">8.1.2.</span> <span class="nav-text">void successfulAuthentication(HttpServletRequest request, HttpServletResponse response, FilterChain chain, Authentication authResult):</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#void-unsuccessfulAuthentication-HttpServletRequest-request-HttpServletResponse-response-AuthenticationException-failed"><span class="nav-number">8.1.3.</span> <span class="nav-text">void unsuccessfulAuthentication(HttpServletRequest request, HttpServletResponse response, AuthenticationException failed):</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0org-springframework-security-core-userdetails-UserDetailsService%E6%8E%A5%E5%8F%A3"><span class="nav-number">8.2.</span> <span class="nav-text">实现org.springframework.security.core.userdetails.UserDetailsService接口:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UserDetails-loadUserByUsername-String-username"><span class="nav-number">8.2.1.</span> <span class="nav-text">UserDetails loadUserByUsername(String username)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0org-springframework-security-crypto-password-PasswordEncoder%E6%8E%A5%E5%8F%A3"><span class="nav-number">8.3.</span> <span class="nav-text">实现org.springframework.security.crypto.password.PasswordEncoder接口:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#String-encode-CharSequence-rawPassword"><span class="nav-number">8.3.1.</span> <span class="nav-text">String encode(CharSequence rawPassword)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#boolean-matches-CharSequence-rawPassword-String-encodedPassword"><span class="nav-number">8.3.2.</span> <span class="nav-text">boolean matches(CharSequence rawPassword, String encodedPassword)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#boolean-upgradeEncoding-String-encodedPassword"><span class="nav-number">8.3.3.</span> <span class="nav-text">boolean upgradeEncoding(String encodedPassword):</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E7%99%BB%E5%BD%95%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81"><span class="nav-number">9.</span> <span class="nav-text">设置登录的用户名和密码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">9.1.</span> <span class="nav-text">配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="nav-number">9.2.</span> <span class="nav-text">配置类</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90%E9%85%8D%E7%BD%AE"><span class="nav-number">10.</span> <span class="nav-text">访问权限配置</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2"><span class="nav-number">11.</span> <span class="nav-text">登录页面</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B3%A8%E8%A7%A3"><span class="nav-number">12.</span> <span class="nav-text">注解</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E7%99%BB%E5%BD%95"><span class="nav-number">13.</span> <span class="nav-text">自动登录</span></a></li></ol>
    </div>
</div>
            </div>
        
    </div>
</div>


                

            </div>



        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2022</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">Patrick</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                
                    <span id="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v0.3.5</a>
        </div>
        
        
    </div>
    <link rel="stylesheet" href="//evan.beee.top/css/waline.css"/>
    <script src="//evan.beee.top/js/waline.js"></script>
    
<link rel="stylesheet" href="/css/regular.min.css">

</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fa-duotone fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>




    
<script src="/js/lazyload.js"></script>



<div class="post-scripts pjax">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            REDEFINE.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            REDEFINE.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            REDEFINE.refresh();
        });
    });
</script>



</body>
</html>
